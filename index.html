<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Cooking</title>
		<style>
			html,
			body {
				margin: 0;
				height: 100%;
				background: black;
				color: #0f0;
				font-family: monospace;
				overflow: hidden;
			}
			#terminal {
				padding: 20px;
				font-size: 20px;
				white-space: pre;
			}
			canvas {
				display: none;
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
			}
			#asciiOverlay {
				position: absolute;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				white-space: pre;
				text-align: center;
				color: #0f0;
				font-size: 18px;
				font-family: monospace;
				display: none;
			}
			#videoOverlay {
				display: none;
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				object-fit: contain;
				pointer-events: none;
			}
			.cursor {
				display: inline-block;
				width: 8px;
				background: #0f0;
				margin-left: 2px;
				animation: blink 1s step-start infinite;
			}
			@keyframes blink {
				50% {
					opacity: 0;
				}
			}
		</style>
	</head>
	<body>
		<div id="terminal"></div>
		<canvas id="c"></canvas>
		<pre id="asciiOverlay"></pre>
		<video id="videoOverlay" muted playsinline>
			<source
				src="https://cdn.onslaught2342.qzz.io/assets/Intro.webm"
				type="video/webm"
			/>
		</video>

		<script>
			const terminal = document.getElementById("terminal");
			const canvas = document.getElementById("c");
			const ctx = canvas.getContext("2d");
			const asciiOverlay = document.getElementById("asciiOverlay");
			const videoOverlay = document.getElementById("videoOverlay");

			function typeLine(line, delay = 40) {
				return new Promise((resolve) => {
					let i = 0;
					function step() {
						terminal.textContent += line.charAt(i);
						i++;
						if (i < line.length) {
							setTimeout(step, delay);
						} else {
							terminal.textContent += "\n";
							resolve();
						}
					}
					step();
				});
			}

			function typeAsciiLine(line, delay = 150) {
				return new Promise((resolve) => {
					terminal.textContent += line + "\n";
					setTimeout(resolve, delay);
				});
			}

			function typePassword(prefix, delay = 100, length = 8) {
				return new Promise((resolve) => {
					terminal.textContent += prefix;
					let i = 0;
					function step() {
						terminal.textContent += "*";
						i++;
						if (i < length) {
							setTimeout(step, delay);
						} else {
							terminal.textContent += "\n";
							resolve();
						}
					}
					step();
				});
			}

			function typeWithCursor(text, speed = 100) {
				return new Promise((resolve) => {
					let i = 0;
					const cursor = document.createElement("span");
					cursor.className = "cursor";
					terminal.appendChild(cursor);
					function step() {
						if (i < text.length) {
							cursor.insertAdjacentText("beforebegin", text.charAt(i));
							i++;
							setTimeout(step, speed);
						} else {
							cursor.remove();
							terminal.textContent += "\n";
							resolve();
						}
					}
					step();
				});
			}

			async function bootSequence() {
				await typeLine("[    0.000000] Booting AbdulOS v1.0 ...", 21);
				await typeLine("[    0.004321] Initializing hardware........ [OK]", 23);
				await typeLine(
					"[    0.010932] Mounting /root................. [OK]",
					24
				);
				await typeLine(
					"[    0.019876] Loading kernel................. [OK]",
					22
				);
				await typeLine(
					"[    0.028345] Launching userland............. [OK]",
					22
				);

				await typeWithCursor("AbdulOS Login: Abdul Nafay", 120);
				await typeWithCursor("Password: ********", 120);
				await typeWithCursor("$ python letscook.py", 120);

				const asciiSmall = [
					".____           __    /\\                            __    ",
					"|    |    _____/  |_  )/______   ____  ____   ____ |  | __",
					"|    |  _/ __ \\   __\\  /  ___/ _/ ___\\/  _ \\ /  _ \\|  |/ /",
					"|    |__\\  ___/|  |    \\___ \\  \\  \\__(  <_> |  <_> )    < ",
					"|_______ \\___  >__|   /____  >  \\___  >____/ \\____/|__|_ \\",
					"        \\/   \\/            \\/       \\/                  \\/",
				];
				for (const line of asciiSmall) {
					await typeAsciiLine(line, 180);
				}

				await typeLine("\n[ OUTPUT ] Cooking sequence initialized...", 30);
				await typeLine("[ OUTPUT ] Engaging full system resources...", 30);

				terminal.style.display = "none";
				canvas.style.display = "block";
				startMatrix();

				const asciiBig = [
					"░██                       ░██       ░██                                                ░██       ",
					"░██                       ░██       ░██                                                ░██       ",
					"░██          ░███████  ░████████    ░██  ░███████      ░███████   ░███████   ░███████  ░██    ░██",
					"░██         ░██    ░██    ░██           ░██           ░██    ░██ ░██    ░██ ░██    ░██ ░██   ░██ ",
					"░██         ░█████████    ░██            ░███████     ░██        ░██    ░██ ░██    ░██ ░███████  ",
					"░██         ░██           ░██                  ░██    ░██    ░██ ░██    ░██ ░██    ░██ ░██   ░██ ",
					"░██████████  ░███████      ░████         ░███████      ░███████   ░███████   ░███████  ░██    ░██",
				];

				asciiOverlay.textContent =
					asciiBig.join("\n") +
					"\n\n[ OUTPUT ] Matrix unlocked. Entering cyberspace...";
				asciiOverlay.style.display = "block";

				setTimeout(() => {
					asciiOverlay.style.transition = "opacity 1s";
					asciiOverlay.style.opacity = 0;
					setTimeout(() => {
						asciiOverlay.style.display = "none";
						videoOverlay.style.display = "block";
						videoOverlay.play().catch(() => {
							const evt = new MouseEvent("click", { bubbles: true });
							document.body.dispatchEvent(evt);
						});
						document.body.addEventListener(
							"click",
							() => {
								videoOverlay.play();
							},
							{ once: true }
						);
						videoOverlay.addEventListener("ended", () => {
							videoOverlay.pause();
							videoOverlay.currentTime = 0;
							videoOverlay.style.display = "none";
							videoOverlay.remove();
						});
					}, 1000);
				}, 4000);
			}

			function startMatrix() {
				function resize() {
					canvas.width = innerWidth;
					canvas.height = innerHeight;
				}
				addEventListener("resize", resize);
				resize();
				const symbols =
					"アカサタナハマヤラワ0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyzΩЖΨѪѬ₪¤¥";
				const fontSize = 16;
				let columns = Math.floor(canvas.width / fontSize);
				let drops = new Array(columns).fill(0);
				function frame() {
					ctx.fillStyle = "rgba(0,0,0,0.07)";
					ctx.fillRect(0, 0, canvas.width, canvas.height);
					ctx.fillStyle = "#0F0";
					ctx.font = fontSize + "px monospace";
					for (let i = 0; i < drops.length; i++) {
						const char = symbols.charAt(
							Math.floor(Math.random() * symbols.length)
						);
						ctx.fillText(char, i * fontSize, drops[i] * fontSize);
						if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) {
							drops[i] = 0;
						}
						drops[i]++;
					}
					requestAnimationFrame(frame);
				}
				frame();
			}

			bootSequence();
		</script>
	</body>
</html>
